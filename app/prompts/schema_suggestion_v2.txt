I have an array of data source objects describing a csv file. I want to convert them into a knowledge graph schema. Some of the data source objects represent entities and others represent connections between entities. Entities implement the interface "Entity" and connections implement the interface "Connection". Each object in the input data sources array implements the interface "DataSource".

```typescript
interface DataSource {
  id: string;
  file: File;
  columns: string[];
  sampleRow: string[];
}

interface Node {
  id: string;
  type: "entity";
  position: {x: 0, y: 0};
  data: {
    name: string;
    table: string;
    primaryKey: string;
    properties: {
      [key: string]: Property;
    };
  };
}

interface Connection {
  id: string;
  type: "relation";
  source: string;
  target: string;
  name: string;
  data: {
    [key: string]: ConnectionType;
  };
}

interface ConnectionType {
  name: string;
  reversed: boolean;
  table: string;
  source: string;
  target: string;
  error?: { [key: string]: string };
  properties: {
    [key: string]: Property;
  };
}

interface Property {
  name?: string;
  col: string;
  type: 'int' | 'text' | 'double';
  checked: true;
}

interface Schema {
  nodes: Entity[];
  edges: Connection[];
}
```

**Rules:**
- All of the columns in the "columns" field of the data source needs to be included in the "properties" field of entities and connections.
- The "table" field is the "id" field of the data source file associated with the entity or connection.
- Each property may define a unique "name" field to avoid collision with other properties.
- In the "Connection" interface, "source" and "target" refer to the "id" field of the nodes it is connecting (not the node name).
- In the "ConnectionType" interface, "source" and "target" refer to the headers of the data source that contains the IDs of the source and target entities respectively. For example, for a ConnectionType that connects a person entity with a company entity, the "source" and "target" fields maybe set to "person_id" and "company_id" respectively, given those fields are present in the data source headers array.
- No two nodes can have multiple Connection objects in the schema. If they have multiple relationships, they will have a single Connection object with multiple ConnectionType values set on it. For example, if person and company has "works_at" and "pays_salary_to" relationships, the schema will have a single Connection object for these two entities, with two ConnectionType values set on it each with its own configuration. Since "pays_salary_to" is semantically correct with company set as source and person as target, its "reversed" field will be set to true to indicate its semantic direction.
- The name of the node or edges must not be space-separated; if they are more than one word, they must be separated by an underscore.
- Return only valid JSON. Do not include markdown formatting, triple backticks, or explanations. The response must start with { and end with }.

**Example Data Sources:**
[
  {
    "id":"FxP9qO",
    "file":{
      "name":"data1.csv",
      "size":997,
      "type":"text/csv"
    },
    "columns":[
      "inneighborhood_id",
      "property_id",
      "neighborhood_id"
    ],
    "sampleRow":[
      "01JVC",
      "1",
      "1"
    ]
  },
  {
    "id":"IiiTaI",
    "file":{
      "name":"data2.csv",
      "size":8686,
      "type":"text/csv"
    },
    "columns":[
      "knows_id",
      "person_id_1",
      "person_id_2",
      "relationship"
    ],
    "sampleRow":[
      "01JVD",
      "1",
      "15",
      "Friend"
    ]
  },
  {
    "id":"jc1Pee",
    "file":{
      "name":"data3.csv",
      "size":1345,
      "type":"text/csv"
    },
    "columns":[
      "listedby_id",
      "property_id",
      "person_id",
      "listing_date"
    ],
    "sampleRow":[
      "01JVD",
      "1",
      "192",
      "8/29/2022"
    ]
  },
  {
    "id":"VyAbP2",
    "file":{
      "name":"ds4.csv",
      "size":10652,
      "type":"text/csv"
    },
    "columns":[
      "livesin_id",
      "person_id",
      "property_id",
      "move_in_date",
      "move_out_date"
    ],
    "sampleRow":[
      "01JVD",
      "1",
      "2",
      "8/14/2002",
      "6/30/2011"
    ]
  },
  {
    "id":"iucEcq",
    "file":{
      "name":"data5.csv",
      "size":97,
      "type":"text/csv"
    },
    "columns":[
      "nearby_id",
      "neighborhood_id_1",
      "neighborhood_id_2",
      "distance_km"
    ],
    "sampleRow":[
      "1",
      "1",
      "2",
      "377.66"
    ]
  },
  {
    "id":"FVOTZQ",
    "file":{
      "name":"dataset6.csv",
      "size":187,
      "type":"text/csv"
    },
    "columns":[
      "neighborhood_id",
      "name",
      "city",
      "state"
    ],
    "sampleRow":[
      "1",
      "Bluestem",
      "Louisville",
      "Kentucky"
    ]
  },
  {
    "id":"bzZjuR",
    "file":{
      "name":"data7.csv",
      "size":2959,
      "type":"text/csv"
    },
    "columns":[
      "owns_id",
      "person_id",
      "property_id",
      "ownership_start",
      "ownership_end"
    ],
    "sampleRow":[
      "1",
      "12",
      "117",
      "6/15/2005",
      "11/17/2006"
    ]
  },
  {
    "id":"yB1Q34",
    "file":{
      "name":"data7.csv",
      "size":2009,
      "type":"text/csv"
    },
    "columns":[
      "property_id",
      "address",
      "city",
      "state",
      "zip_code",
      "property_type",
      "bedrooms",
      "bathrooms",
      "square_feet",
      "year_built"
    ],
    "sampleRow":[
      "1",
      "42 Drewry Court",
      "Atlanta",
      "GA",
      "30323",
      "Ranch",
      "5",
      "2",
      "5420",
      "2006"
    ]
  },
  {
    "id":"lausTI",
    "file":{
      "name":"ds8.csv",
      "size":14814,
      "type":"text/csv"
    },
    "columns":[
      "person_id",
      "name",
      "role",
      "phone",
      "email"
    ],
    "sampleRow":[
      "1",
      "Mirilla Petchell",
      "VP Product Management",
      "676-479-5124",
      "mpetchell0@phpbb.com"
    ]
  }
]

**Example Generated Schema:**
{
  "nodes":[
    {
      "id":"1",
      "type":"entity",
      "position":{
        "x":0,
        "y":0
      },
      "data":{
        "name":"Property",
        "table":"yB1Q34",
        "primaryKey":"prop1",
        "properties":{
          "prop1":{
            "col":"property_id",
            "checked":true,
            "type":"text"
          },
          "prop2":{
            "col":"address",
            "checked":true,
            "type":"text"
          },
          "prop3":{
            "col":"city",
            "checked":true,
            "type":"text"
          },
          "prop4":{
            "col":"state",
            "checked":true,
            "type":"text"
          },
          "prop5":{
            "col":"zip_code",
            "checked":true,
            "type":"text"
          },
          "prop6":{
            "col":"property_type",
            "checked":true,
            "type":"text"
          },
          "prop7":{
            "col":"bedrooms",
            "checked":true,
            "type":"int"
          },
          "prop8":{
            "col":"bathrooms",
            "checked":true,
            "type":"int"
          },
          "prop9":{
            "col":"square_feet",
            "checked":true,
            "type":"double"
          },
          "prop10":{
            "col":"year_built",
            "checked":true,
            "type":"int"
          }
        },
        "error":{
          
        }
      }
    },
    {
      "id":"mCZlJk",
      "type":"entity",
      "data":{
        "name":"Person",
        "table":"lausTI",
        "primaryKey":"prop11",
        "properties":{
          "prop11":{
            "col":"person_id",
            "checked":true,
            "type":"text"
          },
          "prop12":{
            "col":"name",
            "checked":true,
            "type":"text"
          },
          "prop13":{
            "col":"role",
            "checked":true,
            "type":"text"
          },
          "prop14":{
            "col":"phone",
            "checked":true,
            "type":"text"
          },
          "prop15":{
            "col":"email",
            "checked":true,
            "type":"text"
          }
        },
        "error":{
          
        }
      },
      "position":{
        "x":0,
        "y":0
      }
    },
    {
      "id":"wSCtEM",
      "type":"entity",
      "data":{
        "name":"Neighborhood",
        "table":"FVOTZQ",
        "primaryKey":"prop16",
        "properties":{
          "prop16":{
            "col":"neighborhood_id",
            "checked":true,
            "type":"text"
          },
          "prop17":{
            "col":"name",
            "checked":true,
            "type":"text"
          },
          "prop18":{
            "col":"city",
            "checked":true,
            "type":"text"
          },
          "prop19":{
            "col":"state",
            "checked":true,
            "type":"text"
          }
        },
        "error":{
          
        }
      },
      "position":{
        "x":0,
        "y":0
      }
    }
  ],
  "edges":[
    {
      "id":"FESYz0",
      "type":"relation",
      "source":"1", # this is the node id
      "target":"mCZlJk", # this is the node id
      "data":{
        "ElZIY3":{
          "name":"listed_by",
          "source":"property_id",
          "target":"person_id",
          "table":"jc1Pee",
          "properties":{
            "prop20":{
              "col":"listedby_id",
              "checked":true,
              "type":"text"
            },
            "prop21":{
              "col":"property_id",
              "checked":true,
              "type":"text"
            },
            "prop22":{
              "col":"person_id",
              "checked":true,
              "type":"text"
            },
            "prop23":{
              "col":"listing_date",
              "checked":true,
              "type":"text"
            }
          },
          "error":{
            
          }
        },
        "9f0eNl":{
          "name":"owns",
          "reversed":true,
          "source":"person_id",
          "target":"property_id",
          "table":"bzZjuR",
          "properties":{
            "prop24":{
              "col":"owns_id",
              "checked":true,
              "type":"text"
            },
            "prop25":{
              "col":"person_id",
              "checked":true,
              "type":"text"
            },
            "prop26":{
              "col":"property_id",
              "checked":true,
              "type":"text"
            },
            "prop27":{
              "col":"ownership_start",
              "checked":true,
              "type":"text"
            },
            "prop28":{
              "col":"ownership_end",
              "checked":true,
              "type":"text"
            }
          },
          "error":{
            
          }
        },
        "SzQg4i":{
          "name":"lives_in",
          "reversed":true,
          "source":"person_id",
          "target":"property_id",
          "table":"VyAbP2",
          "properties":{
            "prop29":{
              "col":"livesin_id",
              "checked":true,
              "type":"text"
            },
            "prop30":{
              "col":"person_id",
              "checked":true,
              "type":"text"
            },
            "prop31":{
              "col":"property_id",
              "checked":true,
              "type":"text"
            },
            "prop32":{
              "col":"move_in_date",
              "checked":true,
              "type":"text"
            },
            "prop33":{
              "col":"move_out_date",
              "checked":true,
              "type":"text"
            }
          },
          "error":{
            
          }
        }
      }
    },
    {
      "id":"uBviIN",
      "type":"relation",
      "source":"1",
      "target":"wSCtEM",
      "data":{
        "lrNk0-":{
          "name":"found_in",
          "source":"property_id",
          "target":"neighborhood_id",
          "table":"FxP9qO",
          "properties":{
            "prop34":{
              "col":"inneighborhood_id",
              "checked":true,
              "type":"text"
            },
            "prop35":{
              "col":"property_id",
              "checked":true,
              "type":"text"
            },
            "prop36":{
              "col":"neighborhood_id",
              "checked":true,
              "type":"text"
            }
          },
          "error":{
            
          }
        }
      }
    },
    {
      "id":"1gH5eF",
      "type":"relation",
      "source":"mCZlJk",
      "target":"mCZlJk",
      "data":{
        "VtIig5":{
          "name":"knows",
          "source":"person_id_1",
          "target":"person_id_2",
          "table":"IiiTaI",
          "properties":{
            "prop37":{
              "col":"knows_id",
              "checked":true,
              "type":"text"
            },
            "prop38":{
              "col":"person_id_1",
              "checked":true,
              "type":"text"
            },
            "prop39":{
              "col":"person_id_2",
              "checked":true,
              "type":"text"
            },
            "prop40":{
              "col":"relationship",
              "checked":true,
              "type":"text"
            }
          },
          "error":{
            
          }
        }
      }
    }
  ]
}

Generate a schema for the following data sources: 